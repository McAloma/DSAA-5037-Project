[2025-05-11 14:10:59.716944] Fold 1/5 - Epoch 1/20 - Loss: 1.6807, Train Acc: 0.4265, Val Acc: 0.5295, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:14:42.459943] Fold 1/5 - Epoch 2/20 - Loss: 1.2911, Train Acc: 0.5709, Val Acc: 0.5900, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:18:24.433522] Fold 1/5 - Epoch 3/20 - Loss: 1.1478, Train Acc: 0.6176, Val Acc: 0.6237, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:22:07.257795] Fold 1/5 - Epoch 4/20 - Loss: 1.0631, Train Acc: 0.6476, Val Acc: 0.6499, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:25:49.757613] Fold 1/5 - Epoch 5/20 - Loss: 1.0027, Train Acc: 0.6686, Val Acc: 0.6654, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:29:32.517722] Fold 1/5 - Epoch 6/20 - Loss: 0.9558, Train Acc: 0.6833, Val Acc: 0.6739, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:33:15.121460] Fold 1/5 - Epoch 7/20 - Loss: 0.9174, Train Acc: 0.6955, Val Acc: 0.6795, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:36:57.838047] Fold 1/5 - Epoch 8/20 - Loss: 0.8846, Train Acc: 0.7062, Val Acc: 0.6841, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:40:40.299998] Fold 1/5 - Epoch 9/20 - Loss: 0.8564, Train Acc: 0.7138, Val Acc: 0.6912, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:44:22.492867] Fold 1/5 - Epoch 10/20 - Loss: 0.8310, Train Acc: 0.7215, Val Acc: 0.6978, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:48:05.380441] Fold 1/5 - Epoch 11/20 - Loss: 0.8077, Train Acc: 0.7282, Val Acc: 0.7015, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:51:48.096289] Fold 1/5 - Epoch 12/20 - Loss: 0.7868, Train Acc: 0.7348, Val Acc: 0.7065, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:55:31.430170] Fold 1/5 - Epoch 13/20 - Loss: 0.7676, Train Acc: 0.7407, Val Acc: 0.7077, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 14:59:08.538199] Fold 1/5 - Epoch 14/20 - Loss: 0.7497, Train Acc: 0.7478, Val Acc: 0.7091, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:02:46.876872] Fold 1/5 - Epoch 15/20 - Loss: 0.7328, Train Acc: 0.7548, Val Acc: 0.7118, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:06:27.601421] Fold 1/5 - Epoch 16/20 - Loss: 0.7170, Train Acc: 0.7595, Val Acc: 0.7154, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:10:10.066662] Fold 1/5 - Epoch 17/20 - Loss: 0.7020, Train Acc: 0.7657, Val Acc: 0.7196, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:13:52.738028] Fold 1/5 - Epoch 18/20 - Loss: 0.6880, Train Acc: 0.7712, Val Acc: 0.7218, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:17:35.327905] Fold 1/5 - Epoch 19/20 - Loss: 0.6745, Train Acc: 0.7759, Val Acc: 0.7259, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:21:17.531361] Fold 1/5 - Epoch 20/20 - Loss: 0.6614, Train Acc: 0.7797, Val Acc: 0.7293, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:25:40.211221] Fold 2/5 - Epoch 1/20 - Loss: 1.6891, Train Acc: 0.4241, Val Acc: 0.5251, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:29:22.959816] Fold 2/5 - Epoch 2/20 - Loss: 1.3097, Train Acc: 0.5609, Val Acc: 0.5922, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:33:05.770121] Fold 2/5 - Epoch 3/20 - Loss: 1.1647, Train Acc: 0.6115, Val Acc: 0.6223, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:36:48.795489] Fold 2/5 - Epoch 4/20 - Loss: 1.0766, Train Acc: 0.6443, Val Acc: 0.6505, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:40:31.974214] Fold 2/5 - Epoch 5/20 - Loss: 1.0141, Train Acc: 0.6675, Val Acc: 0.6634, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:44:14.691786] Fold 2/5 - Epoch 6/20 - Loss: 0.9653, Train Acc: 0.6826, Val Acc: 0.6761, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:47:57.023169] Fold 2/5 - Epoch 7/20 - Loss: 0.9252, Train Acc: 0.6941, Val Acc: 0.6862, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:51:38.719288] Fold 2/5 - Epoch 8/20 - Loss: 0.8914, Train Acc: 0.7051, Val Acc: 0.6940, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:55:21.666746] Fold 2/5 - Epoch 9/20 - Loss: 0.8619, Train Acc: 0.7145, Val Acc: 0.6978, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 15:59:03.189901] Fold 2/5 - Epoch 10/20 - Loss: 0.8358, Train Acc: 0.7227, Val Acc: 0.7017, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:02:42.659856] Fold 2/5 - Epoch 11/20 - Loss: 0.8121, Train Acc: 0.7305, Val Acc: 0.7051, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:06:25.614290] Fold 2/5 - Epoch 12/20 - Loss: 0.7907, Train Acc: 0.7380, Val Acc: 0.7075, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:10:08.379076] Fold 2/5 - Epoch 13/20 - Loss: 0.7712, Train Acc: 0.7443, Val Acc: 0.7099, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:13:51.329438] Fold 2/5 - Epoch 14/20 - Loss: 0.7524, Train Acc: 0.7511, Val Acc: 0.7136, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:17:34.295856] Fold 2/5 - Epoch 15/20 - Loss: 0.7354, Train Acc: 0.7574, Val Acc: 0.7158, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:21:17.327109] Fold 2/5 - Epoch 16/20 - Loss: 0.7195, Train Acc: 0.7620, Val Acc: 0.7188, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:24:59.458766] Fold 2/5 - Epoch 17/20 - Loss: 0.7042, Train Acc: 0.7667, Val Acc: 0.7194, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:28:42.171407] Fold 2/5 - Epoch 18/20 - Loss: 0.6899, Train Acc: 0.7712, Val Acc: 0.7214, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:32:25.072534] Fold 2/5 - Epoch 19/20 - Loss: 0.6762, Train Acc: 0.7771, Val Acc: 0.7218, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:36:07.827052] Fold 2/5 - Epoch 20/20 - Loss: 0.6628, Train Acc: 0.7819, Val Acc: 0.7228, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:40:32.377598] Fold 3/5 - Epoch 1/20 - Loss: 1.6823, Train Acc: 0.4221, Val Acc: 0.5242, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:44:15.093210] Fold 3/5 - Epoch 2/20 - Loss: 1.3154, Train Acc: 0.5577, Val Acc: 0.5903, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:47:58.187403] Fold 3/5 - Epoch 3/20 - Loss: 1.1728, Train Acc: 0.6075, Val Acc: 0.6292, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:51:41.571548] Fold 3/5 - Epoch 4/20 - Loss: 1.0855, Train Acc: 0.6406, Val Acc: 0.6548, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:55:24.333774] Fold 3/5 - Epoch 5/20 - Loss: 1.0235, Train Acc: 0.6598, Val Acc: 0.6724, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 16:59:06.216156] Fold 3/5 - Epoch 6/20 - Loss: 0.9752, Train Acc: 0.6770, Val Acc: 0.6823, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:02:44.649982] Fold 3/5 - Epoch 7/20 - Loss: 0.9356, Train Acc: 0.6900, Val Acc: 0.6921, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:06:27.471088] Fold 3/5 - Epoch 8/20 - Loss: 0.9023, Train Acc: 0.7014, Val Acc: 0.6988, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:10:10.020493] Fold 3/5 - Epoch 9/20 - Loss: 0.8732, Train Acc: 0.7112, Val Acc: 0.7077, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:13:53.331950] Fold 3/5 - Epoch 10/20 - Loss: 0.8476, Train Acc: 0.7191, Val Acc: 0.7127, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:17:35.048533] Fold 3/5 - Epoch 11/20 - Loss: 0.8244, Train Acc: 0.7265, Val Acc: 0.7155, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:21:14.548056] Fold 3/5 - Epoch 12/20 - Loss: 0.8034, Train Acc: 0.7337, Val Acc: 0.7200, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:24:53.593527] Fold 3/5 - Epoch 13/20 - Loss: 0.7842, Train Acc: 0.7389, Val Acc: 0.7228, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:28:36.325482] Fold 3/5 - Epoch 14/20 - Loss: 0.7663, Train Acc: 0.7459, Val Acc: 0.7278, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:32:19.503544] Fold 3/5 - Epoch 15/20 - Loss: 0.7493, Train Acc: 0.7515, Val Acc: 0.7300, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:36:02.540812] Fold 3/5 - Epoch 16/20 - Loss: 0.7336, Train Acc: 0.7560, Val Acc: 0.7312, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:39:45.158344] Fold 3/5 - Epoch 17/20 - Loss: 0.7184, Train Acc: 0.7618, Val Acc: 0.7351, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:43:28.346047] Fold 3/5 - Epoch 18/20 - Loss: 0.7040, Train Acc: 0.7667, Val Acc: 0.7381, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:47:11.063292] Fold 3/5 - Epoch 19/20 - Loss: 0.6905, Train Acc: 0.7718, Val Acc: 0.7401, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:50:54.374923] Fold 3/5 - Epoch 20/20 - Loss: 0.6777, Train Acc: 0.7762, Val Acc: 0.7413, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:55:18.082616] Fold 4/5 - Epoch 1/20 - Loss: 1.6556, Train Acc: 0.4336, Val Acc: 0.5272, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 17:58:59.766618] Fold 4/5 - Epoch 2/20 - Loss: 1.2701, Train Acc: 0.5744, Val Acc: 0.5933, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:02:39.044813] Fold 4/5 - Epoch 3/20 - Loss: 1.1259, Train Acc: 0.6268, Val Acc: 0.6254, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:06:20.176553] Fold 4/5 - Epoch 4/20 - Loss: 1.0402, Train Acc: 0.6566, Val Acc: 0.6472, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:10:03.613797] Fold 4/5 - Epoch 5/20 - Loss: 0.9800, Train Acc: 0.6768, Val Acc: 0.6631, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:13:46.501041] Fold 4/5 - Epoch 6/20 - Loss: 0.9332, Train Acc: 0.6912, Val Acc: 0.6780, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:17:29.571907] Fold 4/5 - Epoch 7/20 - Loss: 0.8954, Train Acc: 0.7049, Val Acc: 0.6881, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:21:12.639986] Fold 4/5 - Epoch 8/20 - Loss: 0.8629, Train Acc: 0.7142, Val Acc: 0.6980, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:24:55.821257] Fold 4/5 - Epoch 9/20 - Loss: 0.8345, Train Acc: 0.7233, Val Acc: 0.7046, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:28:39.398839] Fold 4/5 - Epoch 10/20 - Loss: 0.8091, Train Acc: 0.7325, Val Acc: 0.7083, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:32:22.670408] Fold 4/5 - Epoch 11/20 - Loss: 0.7860, Train Acc: 0.7408, Val Acc: 0.7119, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:36:05.967832] Fold 4/5 - Epoch 12/20 - Loss: 0.7653, Train Acc: 0.7480, Val Acc: 0.7141, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:39:49.019377] Fold 4/5 - Epoch 13/20 - Loss: 0.7458, Train Acc: 0.7540, Val Acc: 0.7175, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:43:31.948185] Fold 4/5 - Epoch 14/20 - Loss: 0.7278, Train Acc: 0.7604, Val Acc: 0.7185, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:47:15.332227] Fold 4/5 - Epoch 15/20 - Loss: 0.7111, Train Acc: 0.7656, Val Acc: 0.7198, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:50:58.971710] Fold 4/5 - Epoch 16/20 - Loss: 0.6948, Train Acc: 0.7723, Val Acc: 0.7212, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:54:41.984510] Fold 4/5 - Epoch 17/20 - Loss: 0.6800, Train Acc: 0.7768, Val Acc: 0.7258, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 18:58:25.188115] Fold 4/5 - Epoch 18/20 - Loss: 0.6654, Train Acc: 0.7811, Val Acc: 0.7274, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:02:07.962144] Fold 4/5 - Epoch 19/20 - Loss: 0.6516, Train Acc: 0.7852, Val Acc: 0.7292, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:05:46.833546] Fold 4/5 - Epoch 20/20 - Loss: 0.6387, Train Acc: 0.7903, Val Acc: 0.7298, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:10:04.490340] Fold 5/5 - Epoch 1/20 - Loss: 1.6694, Train Acc: 0.4349, Val Acc: 0.5268, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:13:43.024339] Fold 5/5 - Epoch 2/20 - Loss: 1.2873, Train Acc: 0.5674, Val Acc: 0.5887, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:17:17.022596] Fold 5/5 - Epoch 3/20 - Loss: 1.1439, Train Acc: 0.6183, Val Acc: 0.6236, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:20:51.427104] Fold 5/5 - Epoch 4/20 - Loss: 1.0573, Train Acc: 0.6487, Val Acc: 0.6506, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:24:27.353783] Fold 5/5 - Epoch 5/20 - Loss: 0.9951, Train Acc: 0.6709, Val Acc: 0.6641, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:28:03.472751] Fold 5/5 - Epoch 6/20 - Loss: 0.9471, Train Acc: 0.6864, Val Acc: 0.6772, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:31:39.939229] Fold 5/5 - Epoch 7/20 - Loss: 0.9078, Train Acc: 0.6985, Val Acc: 0.6845, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:35:16.222020] Fold 5/5 - Epoch 8/20 - Loss: 0.8744, Train Acc: 0.7081, Val Acc: 0.6929, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:38:51.587316] Fold 5/5 - Epoch 9/20 - Loss: 0.8454, Train Acc: 0.7172, Val Acc: 0.6990, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:42:27.727728] Fold 5/5 - Epoch 10/20 - Loss: 0.8196, Train Acc: 0.7271, Val Acc: 0.7026, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:46:04.529415] Fold 5/5 - Epoch 11/20 - Loss: 0.7963, Train Acc: 0.7343, Val Acc: 0.7083, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:49:40.855155] Fold 5/5 - Epoch 12/20 - Loss: 0.7749, Train Acc: 0.7417, Val Acc: 0.7117, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:53:17.936411] Fold 5/5 - Epoch 13/20 - Loss: 0.7552, Train Acc: 0.7484, Val Acc: 0.7127, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 19:56:55.581494] Fold 5/5 - Epoch 14/20 - Loss: 0.7367, Train Acc: 0.7550, Val Acc: 0.7163, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 20:00:32.738471] Fold 5/5 - Epoch 15/20 - Loss: 0.7195, Train Acc: 0.7613, Val Acc: 0.7173, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 20:04:08.825860] Fold 5/5 - Epoch 16/20 - Loss: 0.7029, Train Acc: 0.7684, Val Acc: 0.7220, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 20:07:44.582194] Fold 5/5 - Epoch 17/20 - Loss: 0.6877, Train Acc: 0.7736, Val Acc: 0.7240, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 20:11:20.756594] Fold 5/5 - Epoch 18/20 - Loss: 0.6730, Train Acc: 0.7788, Val Acc: 0.7258, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 20:14:56.739100] Fold 5/5 - Epoch 19/20 - Loss: 0.6591, Train Acc: 0.7830, Val Acc: 0.7270, Task: site, Batch Size: 100, LR: 0.001
[2025-05-11 20:18:32.575327] Fold 5/5 - Epoch 20/20 - Loss: 0.6463, Train Acc: 0.7859, Val Acc: 0.7278, Task: site, Batch Size: 100, LR: 0.001

[2025-05-11 20:19:13.336825] === Final Results ===
Encode Backbone: resnet
WSI model: ABMIL
Task: site
Batch Size: 100, LR: 0.001, Epochs: 20, K-Folds: 5
Average Train Accuracy: 0.7025
Using Encode: resnet
Average Validation Accuracy (all tasks): 0.6862
Average Loss: 0.8940
Task: site - Avg Val Acc: 0.6862

=== Per-Class Validation Accuracy ===
Class 0 - Val Acc: 0.9393 (3404/3624)
Class 1 - Val Acc: 0.7094 (1323/1865)
Class 2 - Val Acc: 0.8017 (2858/3565)
Class 3 - Val Acc: 0.6842 (2470/3610)
Class 4 - Val Acc: 0.5131 (216/421)
Class 5 - Val Acc: 0.5615 (812/1446)
Class 6 - Val Acc: 0.5845 (643/1100)
Class 7 - Val Acc: 0.8063 (1278/1585)
Class 8 - Val Acc: 0.6128 (2078/3391)
Class 9 - Val Acc: 0.7221 (3029/4195)
